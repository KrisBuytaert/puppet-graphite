Listen 443
<VirtualHost *:443>
    ServerName   <%= @fqdn %>
    DocumentRoot "<%= graphite_prefix %>/webapp"
    ErrorLog     <%= log_prefix %>/graphite_error.log
    CustomLog    <%= log_prefix %>/graphite_access.log common
    SSLEngine on
    SSLCertificateFile    /etc/ssl/certs/graphite-selfsigned.crt
    SSLCertificateKeyFile /etc/ssl/certs/graphite-selfsigned.key

    <Location "/">
        SetHandler python-program
        PythonPath "['<%= graphite_prefix %>/webapp'] + sys.path"
        PythonHandler django.core.handlers.modpython
        SetEnv DJANGO_SETTINGS_MODULE graphite.settings
        PythonDebug Off
        PythonAutoReload Off
        AuthLDAPUrl <%= ldap_url %>
        AuthLDAPBindPassword <%= ldap_pw %>
	Require valid-user
    </Location>

    <Location "/content/">
        SetHandler None
        AuthLDAPUrl <%= ldap_url %>
        AuthLDAPBindPassword <%= ldap_pw %>
	AuthLDAPBindDN <% ldap_dn %>
	Require valid-user
    </Location>
</VirtualHost>

